{% liquid
  assign target_page = section.settings.page

  if target_page == blank
    assign onboarding = true
    assign display_title = 'Título de la página'
    assign display_content = 'Aquí aparecerá el contenido de la página seleccionada. Selecciona una página desde la configuración de esta sección.'
  else
    assign onboarding = false
    assign display_title = target_page.title
    assign display_content = target_page.content | strip_html | truncatewords: 40
  endif

  assign media_class_modifier = 'page-showcase--' | append: section.settings.media_width

  if section.settings.media_position == 'right'
    assign media_class_modifier = media_class_modifier | append: ' page-showcase--media-right'
  endif

  assign button_class = 'button'
  if section.settings.button_style == 'button-secondary'
    assign button_class = 'button-secondary'
  elsif section.settings.button_style == 'link'
    assign button_class = 'link'
  endif
%}

<div class="section-background color-{{ section.settings.color_scheme }}"></div>
<div
  class="section section--{{ section.settings.section_width }} page-showcase color-{{ section.settings.color_scheme }} spacing-style {{ media_class_modifier }}"
  data-testid="page-showcase"
  style="
    {%- render 'spacing-style', settings: section.settings %}
    --media-height: {{ section.settings.media_height }};
    --gap-desktop: {{ section.settings.gap_desktop }}px;
    --gap-mobile: {{ section.settings.gap_mobile }}px;
    {%- case section.settings.media_height %}
      {% when '50svh' %}
        --media-height-mobile: 30svh;
      {% when '60svh' %}
        --media-height-mobile: 50svh;
      {% when '80svh' %}
        --media-height-mobile: 70svh;
      {% when '100svh' %}
        --media-height-mobile: 100svh;
      {% else %}
        --media-height-mobile: auto;
    {% endcase -%}
  "
>
  {% if section.settings.title != blank %}
    <div class="page-showcase__header {{ section.settings.heading_alignment }}">
      <h2 class="page-showcase__section-title h3">{{ section.settings.title }}</h2>
    </div>
  {% endif %}

  <div class="page-showcase__inner">
    {%- comment -%} Media Block {%- endcomment -%}
    {% if section.settings.show_image %}
      <div class="page-showcase__media">
        {% if section.settings.image != blank %}
          <div class="page-showcase__image-wrapper">
            <img
              srcset="
                {{ section.settings.image | image_url: width: 350 }} 350w,
                {{ section.settings.image | image_url: width: 750 }} 750w,
                {{ section.settings.image | image_url: width: 1100 }} 1100w,
                {{ section.settings.image | image_url: width: 1500 }} 1500w
              "
              src="{{ section.settings.image | image_url: width: 1100 }}"
              loading="lazy"
              width="{{ section.settings.image.width }}"
              height="{{ section.settings.image.height }}"
              alt="{{ section.settings.image.alt | escape }}"
              class="page-showcase__image"
            >
          </div>
        {% elsif onboarding %}
          <div class="page-showcase__image-wrapper">
            {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg' }}
          </div>
        {% endif %}
      </div>
    {% endif %}

    {%- comment -%} Content Block {%- endcomment -%}
    <div class="page-showcase__content">
      <div class="page-showcase__content-inner">
        {% if section.settings.show_title %}
          <h2 class="page-showcase__title">{{ display_title }}</h2>
        {% endif %}

        {% if section.settings.show_subtitle and section.settings.subtitle != blank %}
          <p class="page-showcase__subtitle">{{ section.settings.subtitle }}</p>
        {% endif %}

        {% if section.settings.show_content %}
          <div class="page-showcase__excerpt">
            {{ display_content }}
          </div>
        {% endif %}

        {% if section.settings.show_button and section.settings.button_text != blank %}
          <a
            href="{% if onboarding %}#{% else %}{{ target_page.url }}{% endif %}"
            class="page-showcase__button {{ button_class }}"
          >
            {{ section.settings.button_text }}
          </a>
        {% endif %}
      </div>
    </div>
  </div>
</div>

{% stylesheet %}
  .page-showcase__header {
    width: 100%;
    margin: var(--page-showcase-header__margin, 0 0 20px);
  }

  .page-showcase__header.text-center {
    text-align: center;
  }

  .page-showcase__header.text-left {
    text-align: left;
  }

  .page-showcase__section-title {
    margin: 0;
  }

  .page-showcase__section-title.h3 {
    font-family: var(--font-body--family);
    color: var(--color-foreground);
    font-size: var(--font-size--h3);
    font-style: normal;
    font-weight: var(--font-accent--weight);
    line-height: 22px;
    letter-spacing: 0.25px;
    text-transform: uppercase;
  }

  .page-showcase__inner {
    display: grid;
    gap: var(--gap-mobile);
    grid-template-columns: 1fr;
    grid-template-areas:
      'media'
      'content';
  }

  @media screen and (min-width: 750px) {
    .page-showcase__header {
      --page-showcase-header__margin: 0 0 30px;
    }

    .page-showcase__inner {
      gap: var(--gap-desktop);
      grid-template-columns: 3.5fr 2.5fr;
      grid-template-areas: 'media content';
    }

    .page-showcase--medium .page-showcase__inner {
      grid-template-columns: 1fr 1fr;
    }

    .page-showcase--narrow .page-showcase__inner {
      grid-template-columns: 1fr 2fr;
    }

    .page-showcase--media-right .page-showcase__inner {
      grid-template-areas: 'content media';
      grid-template-columns: 2.5fr 3.5fr;
    }

    .page-showcase--media-right.page-showcase--medium .page-showcase__inner {
      grid-template-columns: 1fr 1fr;
    }

    .page-showcase--media-right.page-showcase--narrow .page-showcase__inner {
      grid-template-columns: 2fr 1fr;
    }
  }

  .page-showcase__media {
    grid-area: media;
    position: relative;
    overflow: hidden;
  }

  .page-showcase__image-wrapper {
    height: var(--media-height-mobile, auto);
    width: 100%;
  }

  @media screen and (min-width: 750px) {
    .page-showcase__image-wrapper {
      height: var(--media-height, 80svh);
    }
  }

  .page-showcase__image,
  .page-showcase__image-wrapper svg {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .page-showcase__content {
    grid-area: content;
    display: flex;
    align-items: center;
  }

  .page-showcase__content-inner {
    width: 100%;
  }

  .page-showcase__title {
    font-family: var(--font-body--family);
    font-size: var(--font-size--md);
    font-weight: var(--font-accent--weight);
    letter-spacing: 0.25px;
    line-height: 18px;
    margin: var(--page-showcase-title__margin, 0 0 15px);
    color: var(--color-foreground-heading);
    text-transform: uppercase;
  }

  .page-showcase__subtitle {
    font-size: var(--font-size--lg);
    font-weight: var(--font-accent--weight);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin: 0 0 16px;
    color: var(--color-foreground);
  }

  .page-showcase__excerpt {
    font-family: var(--font-body--family);
    font-size: var(--font-size--sm);
    font-weight: var(--font-accent--weight);
    letter-spacing: 0.25px;
    line-height: 16px;
    margin: var(--page-showcase-title__margin, 0 0 15px);
    color: var(--color-foreground-heading);
    text-transform: uppercase;
  }

  .page-showcase__button {
    display: inline-block;
    text-decoration: none;
  }

  @media screen and (max-width: 750px) {
    .page-showcase__inner {
      --page-showcase-title__margin: 0 0 5px;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Página Showcase",
  "tag": "section",
  "class": "page-showcase-section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "page",
      "id": "page",
      "label": "Página"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Título de la sección",
      "default": "Conoce más"
    },
    {
      "type": "select",
      "id": "heading_alignment",
      "label": "Alineación del título",
      "options": [
        {
          "value": "text-left",
          "label": "Izquierda"
        },
        {
          "value": "text-center",
          "label": "Centro"
        }
      ],
      "default": "text-left"
    },
    {
      "type": "header",
      "content": "Contenido"
    },
    {
      "type": "checkbox",
      "id": "show_image",
      "label": "Mostrar imagen",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Imagen",
      "info": "Las páginas no tienen imagen nativa. Selecciona una imagen manualmente."
    },
    {
      "type": "checkbox",
      "id": "show_title",
      "label": "Mostrar título de la página",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_subtitle",
      "label": "Mostrar subtítulo personalizado",
      "default": false
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtítulo",
      "default": "DR. MARTENS",
      "visible_if": "{{ section.settings.show_subtitle }}"
    },
    {
      "type": "checkbox",
      "id": "show_content",
      "label": "Mostrar contenido de la página",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_button",
      "label": "Mostrar botón",
      "default": true
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Texto del botón",
      "default": "VER MÁS",
      "visible_if": "{{ section.settings.show_button }}"
    },
    {
      "type": "select",
      "id": "button_style",
      "label": "Estilo del botón",
      "options": [
        {
          "value": "button",
          "label": "Primario"
        },
        {
          "value": "button-secondary",
          "label": "Secundario"
        },
        {
          "value": "link",
          "label": "Enlace"
        }
      ],
      "default": "button",
      "visible_if": "{{ section.settings.show_button }}"
    },
    {
      "type": "header",
      "content": "Diseño"
    },
    {
      "type": "select",
      "id": "media_position",
      "label": "Posición de la imagen",
      "options": [
        {
          "value": "left",
          "label": "Izquierda"
        },
        {
          "value": "right",
          "label": "Derecha"
        }
      ],
      "default": "left"
    },
    {
      "type": "select",
      "id": "media_width",
      "label": "Ancho de la imagen",
      "options": [
        {
          "value": "narrow",
          "label": "Estrecho"
        },
        {
          "value": "medium",
          "label": "Medio"
        },
        {
          "value": "wide",
          "label": "Ancho"
        }
      ],
      "default": "wide"
    },
    {
      "type": "select",
      "id": "media_height",
      "label": "Altura de la imagen",
      "options": [
        {
          "value": "auto",
          "label": "Automática"
        },
        {
          "value": "50svh",
          "label": "Pequeña"
        },
        {
          "value": "60svh",
          "label": "Media"
        },
        {
          "value": "80svh",
          "label": "Grande"
        },
        {
          "value": "100svh",
          "label": "Pantalla completa"
        }
      ],
      "default": "60svh"
    },
    {
      "type": "range",
      "id": "gap_desktop",
      "label": "Espacio entre imagen y texto (Escritorio)",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 48
    },
    {
      "type": "range",
      "id": "gap_mobile",
      "label": "Espacio entre imagen y texto (Móvil)",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 16
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "Ancho de la sección",
      "options": [
        {
          "value": "page-width",
          "label": "Ancho de página"
        },
        {
          "value": "full-width",
          "label": "Ancho completo"
        }
      ],
      "default": "page-width"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Esquema de color",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "Relleno"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "Arriba",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 48
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "Abajo",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 48
    },
    {
      "type": "header",
      "content": "Rellenos móviles"
    },
    {
      "type": "range",
      "id": "padding-block-start-mobile",
      "label": "Arriba (móvil)",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 32
    },
    {
      "type": "range",
      "id": "padding-block-end-mobile",
      "label": "Abajo (móvil)",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 32
    }
  ],
  "presets": [
    {
      "name": "Página Showcase",
      "category": "Narrativa"
    }
  ]
}
{% endschema %}
